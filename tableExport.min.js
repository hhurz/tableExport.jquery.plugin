!function(t){t.fn.extend({tableExport:function(e){function o(e,o,n,r){return M=t(A).find(e).first().find(o),M.each(function(){D="",l(this,n,O,r+M.length,function(t,e,o){D+=h(t,e,o)+E.csvSeparator}),D=t.trim(D).substring(0,D.length-1),D.length>0&&(P.length>0&&(P+="\n"),P+=D),O++}),M.length}function n(e){var o=[]
return t(e).find("thead").first().find("th").each(function(e,n){void 0!==t(n).attr("data-field")?o[e]=t(n).attr("data-field"):o[e]=""+e}),o}function r(e,o){var n=!1
return E.ignoreColumn.length>0&&("string"==typeof E.ignoreColumn[0]?L.length>o&&void 0!==L[o]&&-1!=t.inArray(L[o],E.ignoreColumn)&&(n=!0):"number"==typeof E.ignoreColumn[0]&&(-1!=t.inArray(o,E.ignoreColumn)||-1!=t.inArray(o-e.length,E.ignoreColumn))&&(n=!0)),n}function l(e,o,n,l,a){if(-1==t.inArray(n,E.ignoreRow)&&-1==t.inArray(n-l,E.ignoreRow)){var i=t(e).filter(function(){return"none"!=t(this).data("tableexport-display")&&(t(this).is(":visible")||"always"==t(this).data("tableexport-display")||"always"==t(this).closest("table").data("tableexport-display"))}).find(o),s=0,d=0
if(i.each(function(e){if(("always"==t(this).data("tableexport-display")||"none"!=t(this).css("display")&&"hidden"!=t(this).css("visibility")&&"none"!=t(this).data("tableexport-display"))&&0==r(i,e)&&"function"==typeof a){var o,l,c=0,f=0
if(void 0!==R[n]&&R[n].length>0)for(o=0;e>=o;o++)void 0!==R[n][o]&&(a(null,n,o),delete R[n][o],e++)
for(d=e,t(this).is("[colspan]")&&(c=parseInt(t(this).attr("colspan")),s+=c>0?c-1:0),t(this).is("[rowspan]")&&(f=parseInt(t(this).attr("rowspan"))),a(this,n,e),o=0;c-1>o;o++)a(null,n,e+o)
if(f)for(l=1;f>l;l++)for(void 0===R[n+l]&&(R[n+l]=[]),R[n+l][e+s]="",o=1;c>o;o++)R[n+l][e+s-o]=""}}),void 0!==R[n]&&R[n].length>0)for(c=0;c<=R[n].length;c++)void 0!==R[n][c]&&(a(null,n,c),delete R[n][c])}}function a(t){if(E.consoleLog===!0&&console.log(t.output()),"string"===E.outputMode)return t.output()
if("base64"===E.outputMode)return S(t.output())
try{var e=t.output("blob")
saveAs(e,E.fileName+".pdf")}catch(o){x(E.fileName+".pdf","data:application/pdf;base64,",t.output())}}function i(t,e,o){var n=0
if(void 0!==o&&(n=o.colspan),n>=0){for(var r=t.width,l=t.textPos.x,a=e.table.columns.indexOf(e.column),i=1;n>i;i++){var s=e.table.columns[a+i]
r+=s.width}if(n>1&&("right"===t.styles.halign?l=t.textPos.x+r-t.width:"center"===t.styles.halign&&(l=t.textPos.x+(r-t.width)/2)),t.width=r,t.textPos.x=l,void 0!==o&&o.rowspan>1&&(t.height=t.height*o.rowspan),"middle"===t.styles.valign||"bottom"===t.styles.valign){var c="string"==typeof t.text?t.text.split(/\r\n|\r|\n/g):t.text,d=c.length||1
d>2&&(t.textPos.y-=(2-j)/2*e.row.styles.fontSize*(d-2)/3)}return!0}return!1}function s(e,o,n){o.each(function(){var o=t(this).children()
if(t(this).is("div")){var r=g(v(this,"background-color"),[255,255,255]),l=g(v(this,"border-top-color"),[0,0,0]),a=w(this,"border-top-width",E.jspdf.unit),i=this.getBoundingClientRect(),c=this.offsetLeft*n.dw,d=this.offsetTop*n.dh,f=i.width*n.dw,h=i.height*n.dh
n.doc.setDrawColor.apply(void 0,l),n.doc.setFillColor.apply(void 0,r),n.doc.setLineWidth(a),n.doc.rect(e.x+c,e.y+d,f,h,a?"FD":"F")}void 0!==o&&o.length>0&&s(e,o,n)})}function d(t){return t.replace(/([.*+?^=!:${}()|\[\]\/\\])/g,"\\$1")}function f(t,e,o){return t.replace(RegExp(d(e),"g"),o)}function h(t,e,o){var n=""
if(null!=t){var r=p(t,e,o),l=null===r||""==r?"":""+r
r instanceof Date?n=E.csvEnclosure+r.toLocaleString()+E.csvEnclosure:(n=f(l,E.csvEnclosure,E.csvEnclosure+E.csvEnclosure),(n.indexOf(E.csvSeparator)>=0||/[\r\n ]/g.test(n))&&(n=E.csvEnclosure+n+E.csvEnclosure))}return n}function u(t){return t=t||"0",t=f(t,E.numbers.html.decimalMark,"."),t=f(t,E.numbers.html.thousandsSeparator,""),"number"==typeof t||jQuery.isNumeric(t)!==!1?t:!1}function p(e,o,n){var r=""
if(null!=e){var l,a=t(e)
if(l=a[0].hasAttribute("data-tableexport-value")?a.data("tableexport-value"):a.html(),"function"==typeof E.onCellHtmlData&&(l=E.onCellHtmlData(a,o,n,l)),E.htmlContent===!0)r=t.trim(l)
else{var i=l.replace(/\n/g,"\u2028").replace(/<br\s*[\/]?>/gi,"⁠"),s=t("<div/>").html(i).contents()
if(i="",t.each(s.text().split("\u2028"),function(e,o){e>0&&(i+=" "),i+=t.trim(o)}),t.each(i.split("⁠"),function(e,o){e>0&&(r+="\n"),r+=t.trim(o).replace(/\u00AD/g,"")}),E.numbers.html.decimalMark!=E.numbers.output.decimalMark||E.numbers.html.thousandsSeparator!=E.numbers.output.thousandsSeparator){var c=u(r)
if(c!==!1){var d=(""+c).split(".")
1==d.length&&(d[1]="")
var f=d[0].length>3?d[0].length%3:0
r=(0>c?"-":"")+(E.numbers.output.thousandsSeparator?(f?d[0].substr(0,f)+E.numbers.output.thousandsSeparator:"")+d[0].substr(f).replace(/(\d{3})(?=\d)/g,"$1"+E.numbers.output.thousandsSeparator):d[0])+(d[1].length?E.numbers.output.decimalMark+d[1]:"")}}}E.escape===!0&&(r=escape(r)),"function"==typeof E.onCellData&&(r=E.onCellData(a,o,n,r))}return r}function y(t,e,o){return e+"-"+o.toLowerCase()}function g(t,e){var o=/^rgb\((\d{1,3}),\s*(\d{1,3}),\s*(\d{1,3})\)$/,n=o.exec(t),r=e
return n&&(r=[parseInt(n[1]),parseInt(n[2]),parseInt(n[3])]),r}function m(e){var o=v(e,"text-align"),n=v(e,"font-weight"),r=v(e,"font-style"),l=""
"start"==o&&(o="rtl"==v(e,"direction")?"right":"left"),n>=700&&(l="bold"),"italic"==r&&(l+=r),""==l&&(l="normal")
var a={style:{align:o,bcolor:g(v(e,"background-color"),[255,255,255]),color:g(v(e,"color"),[0,0,0]),fstyle:l},colspan:parseInt(t(e).attr("colspan"))||0,rowspan:parseInt(t(e).attr("rowspan"))||0}
if(null!==e){var i=e.getBoundingClientRect()
a.rect={width:i.width,height:i.height}}return a}function v(t,e){try{return window.getComputedStyle?(e=e.replace(/([a-z])([A-Z])/,y),window.getComputedStyle(t,null).getPropertyValue(e)):t.currentStyle?t.currentStyle[e]:t.style[e]}catch(o){}return""}function b(t,e,o){var n=100,r=document.createElement("div")
r.style.overflow="hidden",r.style.visibility="hidden",t.appendChild(r),r.style.width=n+o
var l=n/r.offsetWidth
return t.removeChild(r),e*l}function w(t,e,o){var n=v(t,e),r=n.match(/\d+/)
return null!==r?(r=r[0],b(t.parentElement,r,o)):0}function x(t,e,o){var n=window.navigator.userAgent
if(n.indexOf("MSIE ")>0||n.match(/Trident.*rv\:11\./)){var r=document.createElement("iframe")
r&&(document.body.appendChild(r),r.setAttribute("style","display:none"),r.contentDocument.open("txt/html","replace"),r.contentDocument.write(o),r.contentDocument.close(),r.focus(),r.contentDocument.execCommand("SaveAs",!0,t),document.body.removeChild(r))}else{var l=document.createElement("a")
l&&(l.style.display="none",l.download=t,e.toLowerCase().indexOf("base64,")>=0?l.href=e+S(o):l.href=e+encodeURIComponent(o),document.body.appendChild(l),document.createEvent?(null==N&&(N=document.createEvent("MouseEvents")),N.initEvent("click",!0,!1),l.dispatchEvent(N)):document.createEventObject?l.fireEvent("onclick"):"function"==typeof l.onclick&&l.onclick(),document.body.removeChild(l))}}function C(t){t=t.replace(/\x0d\x0a/g,"\n")
for(var e="",o=0;o<t.length;o++){var n=t.charCodeAt(o)
128>n?e+=String.fromCharCode(n):n>127&&2048>n?(e+=String.fromCharCode(n>>6|192),e+=String.fromCharCode(63&n|128)):(e+=String.fromCharCode(n>>12|224),e+=String.fromCharCode(n>>6&63|128),e+=String.fromCharCode(63&n|128))}return e}function S(t){var e,o,n,r,l,a,i,s="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/=",c="",d=0
for(t=C(t);d<t.length;)e=t.charCodeAt(d++),o=t.charCodeAt(d++),n=t.charCodeAt(d++),r=e>>2,l=(3&e)<<4|o>>4,a=(15&o)<<2|n>>6,i=63&n,isNaN(o)?a=i=64:isNaN(n)&&(i=64),c=c+s.charAt(r)+s.charAt(l)+s.charAt(a)+s.charAt(i)
return c}var E={consoleLog:!1,csvEnclosure:'"',csvSeparator:",",csvUseBOM:!0,displayTableName:!1,escape:!1,excelstyles:[],useRowStyles:!1,fileName:"tableExport",htmlContent:!1,ignoreColumn:[],ignoreRow:[],jsonScope:"all",jspdf:{orientation:"p",unit:"pt",format:"a4",margins:{left:20,right:10,top:10,bottom:10},autotable:{styles:{cellPadding:2,rowHeight:12,fontSize:8,fillColor:255,textColor:50,fontStyle:"normal",overflow:"ellipsize",halign:"left",valign:"middle"},headerStyles:{fillColor:[52,73,94],textColor:255,fontStyle:"bold",halign:"center"},alternateRowStyles:{fillColor:245},tableExport:{onAfterAutotable:null,onBeforeAutotable:null,onTable:null}}},numbers:{html:{decimalMark:".",thousandsSeparator:","},output:{decimalMark:".",thousandsSeparator:","}},onCellData:null,onCellHtmlData:null,outputMode:"file",tbodySelector:"tr",tfootSelector:"tr",theadSelector:"tr",tableName:"myTableName",type:"csv",worksheetName:"xlsWorksheetName"},j=1.15,A=this,N=null,k=[],M=[],O=0,R=[],D="",L=[]
if(t.extend(!0,E,e),L=n(A),"csv"==E.type||"txt"==E.type){var P="",T=0
if(O=0,T+=o("thead",E.theadSelector,"th,td",T),T+=o("tbody",E.tbodySelector,"td",T),E.tfootSelector.length&&o("tfoot",E.tfootSelector,"td",T),P+="\n",E.consoleLog===!0&&console.log(P),"string"===E.outputMode)return P
if("base64"===E.outputMode)return S(P)
try{var B=new Blob([P],{type:"text/"+("csv"==E.type?"csv":"plain")+";charset=utf-8"})
saveAs(B,E.fileName+"."+E.type,"csv"!=E.type||E.csvUseBOM===!1)}catch(I){x(E.fileName+"."+E.type,"data:text/"+("csv"==E.type?"csv":"plain")+";charset=utf-8,"+("csv"==E.type&&E.csvUseBOM?"\ufeff":""),P)}}else if("sql"==E.type){O=0
var H="INSERT INTO `"+E.tableName+"` ("
if(k=t(A).find("thead").first().find(E.theadSelector),k.each(function(){l(this,"th,td",O,k.length,function(t,e,o){H+="'"+p(t,e,o)+"',"}),O++,H=t.trim(H),H=t.trim(H).substring(0,H.length-1)}),H+=") VALUES ",M=t(A).find("tbody").first().find(E.tbodySelector),E.tfootSelector.length&&M.push(t(A).find("tfoot").find(E.tfootSelector)),M.each(function(){D="",l(this,"td",O,k.length+M.length,function(t,e,o){D+="'"+p(t,e,o)+"',"}),D.length>3&&(H+="("+D,H=t.trim(H).substring(0,H.length-1),H+="),"),O++}),H=t.trim(H).substring(0,H.length-1),H+=";",E.consoleLog===!0&&console.log(H),"string"===E.outputMode)return H
if("base64"===E.outputMode)return S(H)
try{var B=new Blob([H],{type:"text/plain;charset=utf-8"})
saveAs(B,E.fileName+".sql")}catch(I){x(E.fileName+".sql","data:application/sql;charset=utf-8,",H)}}else if("json"==E.type){var W=[]
k=t(A).find("thead").first().find(E.theadSelector),k.each(function(){var t=[]
l(this,"th,td",O,k.length,function(e,o,n){t.push(p(e,o,n))}),W.push(t)})
var K=[]
M=t(A).find("tbody").first().find(E.tbodySelector),E.tfootSelector.length&&M.push(t(A).find("tfoot").find(E.tfootSelector)),M.each(function(){var e={},o=0
l(this,"td",O,k.length+M.length,function(t,n,r){W.length?e[W[W.length-1][o]]=p(t,n,r):e[o]=p(t,n,r),o++}),0==t.isEmptyObject(e)&&K.push(e),O++})
var F=""
if(F="head"==E.jsonScope?JSON.stringify(W):"data"==E.jsonScope?JSON.stringify(K):JSON.stringify({header:W,data:K}),E.consoleLog===!0&&console.log(F),"string"===E.outputMode)return F
if("base64"===E.outputMode)return S(F)
try{var B=new Blob([F],{type:"application/json;charset=utf-8"})
saveAs(B,E.fileName+".json")}catch(I){x(E.fileName+".json","data:application/json;charset=utf-8;base64,",F)}}else if("xml"===E.type){O=0
var U='<?xml version="1.0" encoding="utf-8"?>'
U+="<tabledata><fields>",k=t(A).find("thead").first().find(E.theadSelector),k.each(function(){l(this,"th,td",O,M.length,function(t,e,o){U+="<field>"+p(t,e,o)+"</field>"}),O++}),U+="</fields><data>"
var z=1
if(M=t(A).find("tbody").first().find(E.tbodySelector),E.tfootSelector.length&&M.push(t(A).find("tfoot").find(E.tfootSelector)),M.each(function(){var t=1
D="",l(this,"td",O,k.length+M.length,function(e,o,n){D+="<column-"+t+">"+p(e,o,n)+"</column-"+t+">",t++}),D.length>0&&"<column-1></column-1>"!=D&&(U+='<row id="'+z+'">'+D+"</row>",z++),O++}),U+="</data></tabledata>",E.consoleLog===!0&&console.log(U),"string"===E.outputMode)return U
if("base64"===E.outputMode)return S(U)
try{var B=new Blob([U],{type:"application/xml;charset=utf-8"})
saveAs(B,E.fileName+".xml")}catch(I){x(E.fileName+".xml","data:application/xml;charset=utf-8;base64,",U)}}else if("excel"==E.type||"xls"==E.type||"word"==E.type||"doc"==E.type){var q="excel"==E.type||"xls"==E.type?"excel":"word",$="excel"==q?"xls":"doc",J='xmlns:x="urn:schemas-microsoft-com:office:'+q+'"',Q=t(A).filter(function(){return"none"!=t(this).data("tableexport-display")&&(t(this).is(":visible")||"always"==t(this).data("tableexport-display"))}),V=""
Q.each(function(){O=0,L=n(this),V+="<table><thead>",k=t(this).find("thead").first().find(E.theadSelector),k.each(function(){D="",l(this,"th,td",O,k.length,function(e,o,n){if(null!=e){var r=""
D+="<th"
for(var l in E.excelstyles)if(E.excelstyles.hasOwnProperty(l)){var a=t(e).css(E.excelstyles[l])
""!=a&&"0px none rgb(0, 0, 0)"!=a&&(""==r&&(r='style="'),r+=E.excelstyles[l]+":"+a+";")}""!=r&&(D+=" "+r+'"'),t(e).is("[colspan]")&&(D+=' colspan="'+t(e).attr("colspan")+'"'),t(e).is("[rowspan]")&&(D+=' rowspan="'+t(e).attr("rowspan")+'"'),D+=">"+p(e,o,n)+"</th>"}}),D.length>0&&(V+="<tr>"+D+"</tr>"),O++}),V+="</thead>",$tbodys=t(this).find("tbody"),$tbodys.each(function(){V+="<tbody>",M=t(this).find(E.tbodySelector),E.tfootSelector.length&&M.push(t(A).find("tfoot").find(E.tfootSelector)),M.each(function(){D=""
var e="",o=this
l(this,"td",O,k.length+M.length,function(n,r,l){if(null!=n){var a="",i=t(n).data("tableexport-msonumberformat")
void 0===i&&"function"==typeof E.onMsoNumberFormat&&(i=E.onMsoNumberFormat(n,r,l)),void 0!==i&&""!=i&&(""==a&&(a='style="'),a="style=\"mso-number-format:'"+i+"'"),D+="<td"
for(var s in E.excelstyles)E.excelstyles.hasOwnProperty(s)&&(i=t(n).css(E.excelstyles[s]),""!=i&&"0px none rgb(0, 0, 0)"!=i&&"rgba(0, 0, 0, 0)"!=i?(""==a&&(a='style="'),a+=E.excelstyles[s]+":"+i+";"):E.useRowStyles&&(e=t(o).css(E.excelstyles[s]),""!=e&&"0px none rgb(0, 0, 0)"!=e&&"rgba(0, 0, 0, 0)"!=e&&(""==a&&(a='style="'),a+=E.excelstyles[s]+":"+e+";")))
""!=a&&(D+=" "+a+'"'),t(n).is("[colspan]")&&(D+=' colspan="'+t(n).attr("colspan")+'"'),t(n).is("[rowspan]")&&(D+=' rowspan="'+t(n).attr("rowspan")+'"'),D+=">"+p(n,r,l)+"</td>"}}),D.length>0&&(V+="<tr>"+D+"</tr>"),O++}),E.displayTableName&&(V+="<tr><td></td></tr><tr><td></td></tr><tr><td>"+p(t("<p>"+E.tableName+"</p>"))+"</td></tr>"),V+="</tbody>"}),V+="</table>",E.consoleLog===!0&&console.log(V)})
var Y='<html xmlns:o="urn:schemas-microsoft-com:office:office" '+J+' xmlns="http://www.w3.org/TR/REC-html40">'
if(Y+='<meta http-equiv="content-type" content="application/vnd.ms-'+q+'; charset=UTF-8">',Y+="<head>","excel"===q&&(Y+="<!--[if gte mso 9]>",Y+="<xml>",Y+="<x:ExcelWorkbook>",Y+="<x:ExcelWorksheets>",Y+="<x:ExcelWorksheet>",Y+="<x:Name>",Y+=E.worksheetName,Y+="</x:Name>",Y+="<x:WorksheetOptions>",Y+="<x:DisplayGridlines/>",Y+="</x:WorksheetOptions>",Y+="</x:ExcelWorksheet>",Y+="</x:ExcelWorksheets>",Y+="</x:ExcelWorkbook>",Y+="</xml>",Y+="<![endif]-->"),Y+="</head>",Y+="<body>",Y+=V,Y+="</body>",Y+="</html>",E.consoleLog===!0&&console.log(Y),"string"===E.outputMode)return Y
if("base64"===E.outputMode)return S(Y)
try{var B=new Blob([Y],{type:"application/vnd.ms-"+E.type})
saveAs(B,E.fileName+"."+$)}catch(I){x(E.fileName+"."+$,"data:application/vnd.ms-"+q+";base64,",Y)}}else if("png"==E.type)html2canvas(t(A)[0]).then(function(t){var e=t.toDataURL()
e=e.substring(22)
for(var o=atob(e),n=new ArrayBuffer(o.length),r=new Uint8Array(n),l=0;l<o.length;l++)r[l]=o.charCodeAt(l)
if(E.consoleLog===!0&&console.log(o),"string"===E.outputMode)return o
if("base64"===E.outputMode)return S(e)
try{var a=new Blob([n],{type:"image/png"})
saveAs(a,E.fileName+".png")}catch(i){x(E.fileName+".png","data:image/png,",e)}})
else if("pdf"==E.type)if(E.jspdf.autotable===!1){var G={dim:{w:w(t(A).first().get(0),"width","mm"),h:w(t(A).first().get(0),"height","mm")},pagesplit:!1},Z=new jsPDF(E.jspdf.orientation,E.jspdf.unit,E.jspdf.format)
Z.addHTML(t(A).first(),E.jspdf.margins.left,E.jspdf.margins.top,G,function(){a(Z)})}else{var X=E.jspdf.autotable.tableExport
if("string"==typeof E.jspdf.format&&"bestfit"===E.jspdf.format.toLowerCase()){var _={a0:[2383.94,3370.39],a1:[1683.78,2383.94],a2:[1190.55,1683.78],a3:[841.89,1190.55],a4:[595.28,841.89]},tt="",et="",ot=0
t(A).filter(":visible").each(function(){if("none"!=t(this).css("display")){var e=w(t(this).get(0),"width","pt")
if(e>ot){e>_.a0[0]&&(tt="a0",et="l")
for(var o in _)_.hasOwnProperty(o)&&_[o][1]>e&&(tt=o,et="l",_[o][0]>e&&(et="p"))
ot=e}}}),E.jspdf.format=""==tt?"a4":tt,E.jspdf.orientation=""==et?"w":et}X.doc=new jsPDF(E.jspdf.orientation,E.jspdf.unit,E.jspdf.format),t(A).filter(function(){return"none"!=t(this).data("tableexport-display")&&(t(this).is(":visible")||"always"==t(this).data("tableexport-display"))}).each(function(){var e,o=0
if(L=n(this),X.columns=[],X.rows=[],X.rowoptions={},"function"==typeof X.onTable&&X.onTable(t(this),E)===!1)return!0
E.jspdf.autotable.tableExport=null
var r=t.extend(!0,{},E.jspdf.autotable)
E.jspdf.autotable.tableExport=X,r.margin={},t.extend(!0,r.margin,E.jspdf.margins),r.tableExport=X,"function"!=typeof r.beforePageContent&&(r.beforePageContent=function(t){if(1==t.pageCount){var e=t.table.rows.concat(t.table.headerRow)
e.forEach(function(e){e.height>0&&(e.height+=(2-j)/2*e.styles.fontSize,t.table.height+=(2-j)/2*e.styles.fontSize)})}}),"function"!=typeof r.createdHeaderCell&&(r.createdHeaderCell=function(e,o){if(e.styles=t.extend({},o.row.styles),void 0!==X.columns[o.column.dataKey]){var n=X.columns[o.column.dataKey]
if(void 0!==n.rect){var l
e.contentWidth=n.rect.width,(void 0===X.heightRatio||0==X.heightRatio)&&(l=o.row.raw[o.column.dataKey].rowspan?o.row.raw[o.column.dataKey].rect.height/o.row.raw[o.column.dataKey].rowspan:o.row.raw[o.column.dataKey].rect.height,X.heightRatio=e.styles.rowHeight/l),l=o.row.raw[o.column.dataKey].rect.height*X.heightRatio,l>e.styles.rowHeight&&(e.styles.rowHeight=l)}void 0!==n.style&&n.style.hidden!==!0&&(e.styles.halign=n.style.align,"inherit"===r.styles.fillColor&&(e.styles.fillColor=n.style.bcolor),"inherit"===r.styles.textColor&&(e.styles.textColor=n.style.color),"inherit"===r.styles.fontStyle&&(e.styles.fontStyle=n.style.fstyle))}}),"function"!=typeof r.createdCell&&(r.createdCell=function(t,e){var o=X.rowoptions[e.row.index+":"+e.column.dataKey]
void 0!==o&&void 0!==o.style&&o.style.hidden!==!0&&(t.styles.halign=o.style.align,"inherit"===r.styles.fillColor&&(t.styles.fillColor=o.style.bcolor),"inherit"===r.styles.textColor&&(t.styles.textColor=o.style.color),"inherit"===r.styles.fontStyle&&(t.styles.fontStyle=o.style.fstyle))}),"function"!=typeof r.drawHeaderCell&&(r.drawHeaderCell=function(t,e){var o=X.columns[e.column.dataKey]
return(1!=o.style.hasOwnProperty("hidden")||o.style.hidden!==!0)&&o.rowIndex>=0?i(t,e,o):!1}),"function"!=typeof r.drawCell&&(r.drawCell=function(t,e){var o=X.rowoptions[e.row.index+":"+e.column.dataKey]
if(i(t,e,o)){if(X.doc.rect(t.x,t.y,t.width,t.height,t.styles.fillStyle),void 0!==o&&void 0!==o.kids&&o.kids.length>0){var n=t.height/o.rect.height;(n>X.dh||void 0===X.dh)&&(X.dh=n),X.dw=t.width/o.rect.width,s(t,o.kids,X)}X.doc.autoTableText(t.text,t.textPos.x,t.textPos.y,{halign:t.styles.halign,valign:t.styles.valign})}return!1}),X.headerrows=[],k=t(this).find("thead").find(E.theadSelector),k.each(function(){e=0,X.headerrows[o]=[],l(this,"th,td",o,k.length,function(t,n,r){var l=m(t)
l.title=p(t,n,r),l.key=e++,l.rowIndex=o,X.headerrows[o].push(l)}),o++}),o>0&&t.each(X.headerrows[o-1],function(){o>1&&null==this.rect?obj=X.headerrows[o-2][this.key]:obj=this,null!=obj&&X.columns.push(obj)})
var a=0
M=t(this).find("tbody").find(E.tbodySelector),E.tfootSelector.length&&M.push(t(A).find("tfoot").find(E.tfootSelector)),M.each(function(){var n=[]
e=0,l(this,"td",o,k.length+M.length,function(o,r,l){if(void 0===X.columns[e]){var i={title:"",key:e,style:{hidden:!0}}
X.columns.push(i)}if(void 0!==o&&null!=o){var i=m(o)
i.kids=t(o).children(),X.rowoptions[a+":"+e++]=i}else{var i=t.extend(!0,{},X.rowoptions[a+":"+(e-1)])
i.colspan=-1,X.rowoptions[a+":"+e++]=i}n.push(p(o,r,l))}),n.length&&(X.rows.push(n),a++),o++}),"function"==typeof X.onBeforeAutotable&&X.onBeforeAutotable(t(this),X.columns,X.rows,r),X.doc.autoTable(X.columns,X.rows,r),"function"==typeof X.onAfterAutotable&&X.onAfterAutotable(t(this),r),E.jspdf.autotable.startY=X.doc.autoTableEndPosY()+r.margin.top}),a(X.doc),void 0!==X.headerrows&&(X.headerrows.length=0),void 0!==X.columns&&(X.columns.length=0),void 0!==X.rows&&(X.rows.length=0),delete X.doc,X.doc=null}return this}})}(jQuery)
